{% extends 'core/base.html' %}
{% load static %}
{% block content %}
<div class="modern-table-container">
  <div class="modern-table-header">
    <h2><i class="fas fa-users mr-2"></i>Tenants</h2>
    <div class="modern-table-actions">
      <a href="{% url 'tenant-create' %}" class="btn btn-primary" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border: none;">
        <i class="fas fa-plus mr-1"></i>Add Tenant
      </a>
    </div>
  </div>

  {% if tenants %}
  <table id="tenantTable" class="modern-table">
    <thead>
      <tr>
        <th>First Name</th>
        <th>Last Name</th>
        <th>Email</th>
        <th>Phone</th>
        <th>Status</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for tenant in tenants %}
      <tr>
        <td><strong>{{ tenant.user.first_name }}</strong></td>
        <td><strong>{{ tenant.user.last_name }}</strong></td>
        <td>{{ tenant.user.email }}</td>
        <td>{{ tenant.mobile_number|default:"Not provided" }}</td>
        <td>
          <span class="badge-modern {% if tenant.current_status == 'active' %}badge-paid{% else %}badge-overdue{% endif %}">
            {{ tenant.current_status|title }}
          </span>
        </td>
        <td>
          <div class="action-buttons">
            <a href="{% url 'tenant-detail' tenant.id %}" class="btn-action btn-action-view" title="View Tenant">
              <i class="fas fa-eye"></i>
              <span class="d-none d-md-inline">View</span>
            </a>
            <a href="{% url 'tenant-update' tenant.id %}" class="btn-action btn-action-edit" title="Edit Tenant">
              <i class="fas fa-edit"></i>
              <span class="d-none d-md-inline">Edit</span>
            </a>
            <a href="{% url 'tenant-delete' tenant.id %}" class="btn-action btn-action-delete" title="Delete Tenant" onclick="return confirm('Are you sure you want to delete this tenant?');">
              <i class="fas fa-trash"></i>
              <span class="d-none d-md-inline">Delete</span>
            </a>
          </div>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  {% else %}
  <div class="table-empty-state">
    <i class="fas fa-users"></i>
    <h3>No Tenants Found</h3>
    <p>There are no tenants registered yet.</p>
  </div>
  {% endif %}
</div>

<script>
  $(document).ready(function() {
    $('#tenantTable').DataTable({
      paging: true,
      searching: true,
      pageLength: 10,
      lengthMenu: [[10, 25, 50, -1], [10, 25, 50, "All"]],
      language: {
        search: "",
        searchPlaceholder: "Search tenants...",
        lengthMenu: "Show _MENU_ entries",
        info: "Showing _START_ to _END_ of _TOTAL_ entries",
        paginate: {
          previous: "<i class='fas fa-chevron-left'></i>",
          next: "<i class='fas fa-chevron-right'></i>"
        }
      },
      columnDefs: [
        { orderable: false, targets: [5] } // Disable sorting on Actions column
      ],
      responsive: true
    });
  });
</script>
{% endblock content %}
{% block custom_js %}
<script>
$(document).ready(function() {
  // Move to the next tab when Next button is clicked
  $('.next-tab').click(function() {
    var currentTab = $(this).closest('.tab-pane');
    var nextTab = currentTab.next('.tab-pane');
    var navLink = $(this).closest('.nav-item').next('.nav-item').find('.nav-link');

    currentTab.removeClass('active');
    nextTab.addClass('active');

    // Update active tab in the navigation
    $('.nav-link').removeClass('active');
    navLink.addClass('active');
  });
});
</script>
{% endblock custom_js %}