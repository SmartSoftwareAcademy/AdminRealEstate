{% extends 'core/base.html' %}
{% load static %}
{% block content %}
<div class="modern-table-container">
  <div class="modern-table-header">
    <h2><i class="fas fa-building mr-2"></i>Properties</h2>
    <div class="modern-table-actions">
      <a href="{% url 'property-create' %}" class="btn btn-primary" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border: none;">
        <i class="fas fa-plus mr-1"></i>Add Property
      </a>
    </div>
  </div>

  {% if properties %}
  <table id="propertyTable" class="modern-table">
    <thead>
      <tr>
        <th>Property Name</th>
        <th>Property Type</th>
        <th>Property Owner</th>
        <th>Address</th>
        <th>Units</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for prop in properties %}
      <tr>
        <td><strong>{{ prop.property_name }}</strong></td>
        <td><span class="text-capitalize">{{ prop.property_type }}</span></td>
        <td>{{ prop.owner.user.get_full_name|default:prop.owner.user.email }}</td>
        <td>{{ prop.address|truncatewords:5 }}</td>
        <td>
          <span class="badge badge-info">{{ prop.units.all|length }}</span>
        </td>
        <td>
          <div class="action-buttons">
            <a href="{% url 'property-detail' prop.id %}" class="btn-action btn-action-view" title="View Property">
              <i class="fas fa-eye"></i>
              <span class="d-none d-md-inline">View</span>
            </a>
            <a href="{% url 'property-update' prop.id %}" class="btn-action btn-action-edit" title="Edit Property">
              <i class="fas fa-edit"></i>
              <span class="d-none d-md-inline">Edit</span>
            </a>
            <a href="{% url 'property-delete' prop.id %}" class="btn-action btn-action-delete" title="Delete Property" onclick="return confirm('Are you sure you want to delete this property?');">
              <i class="fas fa-trash"></i>
              <span class="d-none d-md-inline">Delete</span>
            </a>
          </div>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  {% else %}
  <div class="table-empty-state">
    <i class="fas fa-building"></i>
    <h3>No Properties Found</h3>
    <p>There are no properties registered yet.</p>
  </div>
  {% endif %}
</div>

<script>
  $(document).ready(function() {
    $('#propertyTable').DataTable({
      paging: true,
      searching: true,
      pageLength: 10,
      lengthMenu: [[10, 25, 50, -1], [10, 25, 50, "All"]],
      language: {
        search: "",
        searchPlaceholder: "Search properties...",
        lengthMenu: "Show _MENU_ entries",
        info: "Showing _START_ to _END_ of _TOTAL_ entries",
        paginate: {
          previous: "<i class='fas fa-chevron-left'></i>",
          next: "<i class='fas fa-chevron-right'></i>"
        }
      },
      columnDefs: [
        { orderable: false, targets: [5] } // Disable sorting on Actions column
      ],
      responsive: true
    });
  });
</script>
{% endblock content %}
{% block custom_js %}
<script>
</script>
{% endblock custom_js %}