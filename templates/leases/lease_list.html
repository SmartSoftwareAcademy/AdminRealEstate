{% extends 'core/base.html' %}
{% load static %}
{% block content %}
<div class="modern-table-container">
  <div class="modern-table-header">
    <h2><i class="fas fa-file-contract mr-2"></i>Leases</h2>
    <div class="modern-table-actions">
      <a href="{% url 'lease-create' %}" class="btn btn-primary" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border: none;">
        <i class="fas fa-plus mr-1"></i>Create New Lease
      </a>
    </div>
  </div>

  {% if leases %}
  <table id="leaseTable" class="modern-table">
    <thead>
      <tr>
        <th>#</th>
        <th>Property Unit</th>
        <th>Tenant</th>
        <th>Start Date</th>
        <th>End Date</th>
        <th>Status</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for lease in leases %}
      <tr>
        <td>{{ forloop.counter }}</td>
        <td><strong>{{ lease.property_unit }}</strong></td>
        <td>{{ lease.tenant.user.get_full_name|default:lease.tenant.user.email }}</td>
        <td>{{ lease.start_date|date:"M d, Y" }}</td>
        <td>{{ lease.end_date|date:"M d, Y" }}</td>
        <td>
          <span class="badge-modern {% if lease.is_active %}badge-paid{% else %}badge-overdue{% endif %}">
            {% if lease.is_active %}Active{% else %}Inactive{% endif %}
          </span>
        </td>
        <td>
          <div class="action-buttons">
            <a href="{% url 'lease-detail' lease.id %}" class="btn-action btn-action-view" title="View Lease">
              <i class="fas fa-eye"></i>
              <span class="d-none d-md-inline">View</span>
            </a>
            <a href="{% url 'lease-update' lease.id %}" class="btn-action btn-action-edit" title="Edit Lease">
              <i class="fas fa-edit"></i>
              <span class="d-none d-md-inline">Edit</span>
            </a>
            <a href="{% url 'lease-delete' lease.id %}" class="btn-action btn-action-delete" title="Delete Lease" onclick="return confirm('Are you sure you want to delete this lease?');">
              <i class="fas fa-trash"></i>
              <span class="d-none d-md-inline">Delete</span>
            </a>
          </div>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  {% else %}
  <div class="table-empty-state">
    <i class="fas fa-file-contract"></i>
    <h3>No Leases Found</h3>
    <p>There are no leases registered yet.</p>
  </div>
  {% endif %}
</div>

<script>
  $(document).ready(function() {
    $('#leaseTable').DataTable({
      paging: true,
      searching: true,
      pageLength: 10,
      lengthMenu: [[10, 25, 50, -1], [10, 25, 50, "All"]],
      language: {
        search: "",
        searchPlaceholder: "Search leases...",
        lengthMenu: "Show _MENU_ entries",
        info: "Showing _START_ to _END_ of _TOTAL_ entries",
        paginate: {
          previous: "<i class='fas fa-chevron-left'></i>",
          next: "<i class='fas fa-chevron-right'></i>"
        }
      },
      columnDefs: [
        { orderable: false, targets: [6] } // Disable sorting on Actions column
      ],
      responsive: true
    });
  });
</script>
{% endblock %}
